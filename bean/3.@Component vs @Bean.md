ржЪрж▓ ржПржЦржи ржПржЗ ржХрзЛржбржЯрж╛ **ржПржХржжржо ржнрж┐рждрж░ ржкрж░рзНржпржирзНржд ржнрзЗржЩрзЗ ржмрзБржЭрж┐** ЁЯСЗ
ржзрзАрж░рзЗ ржзрзАрж░рзЗ, confusion zero рж░рж╛ржЦржмред

---

## ЁЯФз ржПржЗ ржХрзЛржбржЯрж╛ ржЖржмрж╛рж░ ржжрзЗржЦрж┐

```java
@Configuration
class AppConfig {

    @Bean
    public UserService userService() {
        return new UserService();
    }
}
```

---

## ЁЯза Big picture (ржЖржЧрзЗ ржмрзБржЭрзЗ ржирж╛ржУ)

ржПржЦрж╛ржирзЗ рждрзБржорж┐ Spring-ржХрзЗ **ржмрж▓ржЫрзЛ ржирж╛ тАЬржПржЗ class manage ржХрж░рзЛтАЭ**
ЁЯСЙ рждрзБржорж┐ ржмрж▓ржЫрзЛ:

> **тАЬржПржЗ method ржпрзЗржЗ object return ржХрж░ржмрзЗ, ржУржЯрж╛ржЗ Bean ржмрж╛ржирж╛ржУтАЭ**

---

# ЁЯФ╣ Part 1: `@Configuration` ржорж╛ржирзЗ ржХрзА?

### рж╕рж╣ржЬ ржнрж╛рж╖рж╛рзЯ

> **`@Configuration` ржорж╛ржирзЗ тЖТ ржПржЗ class ржЯрж╛ Bean factory**

Spring ржмрзБржЭрзЗ:

* ржПржЗ class ржПрж░ ржнрж┐рждрж░рзЗ `@Bean` method ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ
* ржПржЧрзБрж▓рзЛ call ржХрж░рзЗ Bean ржмрж╛ржирж╛рждрзЗ рж╣ржмрзЗ

ЁЯУМ `@Configuration` ржирж┐ржЬрзЗржУ ржПржХржЯрж╛ `@Component`
рждрж╛ржЗ ржПржЯрж╛ржУ Spring scan ржХрж░рзЗред

---

## ЁЯФ╣ Part 2: `@Bean` ржорж╛ржирзЗ ржХрзА?

### ржПржХ рж▓рж╛ржЗржирзЗ

> **`@Bean` ржорж╛ржирзЗ тЖТ ржПржЗ method ржПрж░ return ржХрж░рж╛ object ржЯрж╛ Spring Bean**

ржПржЗ method:

```java
public UserService userService() {
    return new UserService();
}
```

Spring ржнрж┐рждрж░рзЗ ржнрж┐рждрж░рзЗ ржХрж░рзЗ:

```java
UserService obj = userService();
container.put("userService", obj);
```

тЮбя╕П ржПржЗ `obj`-ржЯрж╛ржЗ **Bean**

---

## ЁЯФ╣ ржПржЦрж╛ржирзЗ Bean ржХрзЛржиржЯрж╛?

тЭМ Bean = `UserService` class
тЭМ Bean = `userService()` method

тЬЕ **Bean = `new UserService()` object**

---

## ЁЯФД Spring Startup ржП ржХрзА рж╣рзЯ? (Step by step)

### Step 1я╕ПтГг Spring App ржЪрж╛рж▓рзБ

```java
SpringApplication.run(...)
```

### Step 2я╕ПтГг Spring scan ржХрж░рзЗ

* `@Configuration` ржжрзЗржЦрзЗ
* `AppConfig` ржХрзЗ manage ржХрж░рзЗ

### Step 3я╕ПтГг Spring ржЦрзЛржБржЬрзЗ

* ржПржЗ class ржП `@Bean` ржЖржЫрзЗ ржХрж┐ржирж╛

### Step 4я╕ПтГг Method call ржХрж░рзЗ

```java
UserService u = appConfig.userService();
```

### Step 5я╕ПтГг Object container-ржП рж░рж╛ржЦрзЗ

```
ApplicationContext
 тФФтФАтФА userService тЖТ UserService object
```

---

## ЁЯФБ рждрж╛рж░ржкрж░ `@Autowired` рж╣рж▓рзЗ ржХрзА рж╣рзЯ?

```java
@Autowired
UserService userService;
```

Spring ржмрж▓рзЗ:

> тАЬржЖржорж╛рж░ ржХрж╛ржЫрзЗ `UserService` type ржПрж░ ржПржХржЯрж╛ Bean ржЖржЫрзЗ
> ржирж╛ржо `userService`
> ржПржЗ ржирж╛ржУтАЭ

---

## ЁЯзй `@Component` vs `@Bean` (ржЦрзБржм ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг)

| ржмрж┐рж╖рзЯ      | `@Component`   | `@Bean`                   |
| --------- | -------------- | ------------------------- |
| ржХрзЗ ржмрж╛ржирж╛рзЯ  | Spring         | рждрзБржорж┐                      |
| new ржХрзЛржерж╛рзЯ | Spring         | рждрзЛржорж╛рж░ code                |
| Use case  | Normal classes | 3rd-party / control ржжрж░ржХрж╛рж░ |

---

## ЁЯзк ржХрзЗржи `@Bean` ржжрж░ржХрж╛рж░ рж╣рзЯ?

### 1я╕ПтГг Third-party class

```java
@Bean
public Gson gson() {
    return new Gson();
}
```

рждрзБржорж┐ `Gson` ржП annotation ржжрж┐рждрзЗ ржкрж╛рж░рзЛ ржирж╛ тЭМ
рждрж╛ржЗ `@Bean` ржжрж░ржХрж╛рж░ тЬФ

---

### 2я╕ПтГг Custom creation logic

```java
@Bean
public DataSource dataSource() {
    return buildSecureDataSource();
}
```

---

## тЪая╕П ржПржХржЯрж╛ ржЦрзБржм ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржЬрж┐ржирж┐рж╕ (ADVANCE ржХрж┐ржирзНрждрзБ ржЬрж░рзБрж░рж┐)

### `@Configuration` proxy ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ

```java
@Bean
UserService u1() { return new UserService(); }

@Bean
OrderService o1() {
    return new OrderService(u1());
}
```

Spring ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗ:

* `u1()` **ржжрзБржЗржмрж╛рж░ call рж╣рж▓рзЗржУ**
* **ржПржХржЗ Bean** ржкрж╛ржУрзЯрж╛ ржпрж╛ржмрзЗ (singleton)

ржПржЯрж╛ рж╣рзЯ CGLIB proxy ржжрж┐рзЯрзЗ
ЁЯСЙ ржПржЬржирзНржп `@Configuration` ржжрж░ржХрж╛рж░

---

## ЁЯза ржоржирзЗ рж░рж╛ржЦрж╛рж░ shortcut

> `@Component` тЖТ тАЬржПржЗ class manage ржХрж░рзЛтАЭ
> `@Bean` тЖТ тАЬржПржЗ object manage ржХрж░рзЛтАЭ

---

## ЁЯОп Final ржПржХ рж▓рж╛ржЗржирзЗ

> **`@Configuration` class ржПрж░ `@Bean` method ржпрзЗржЗ object return ржХрж░рзЗ, Spring рж╕рзЗржЗ object-ржХрзЗржЗ Bean ржмрж╛ржирж╛рзЯ ржУ manage ржХрж░рзЗред**

---

ржЪрж╛ржУ рждрзЛ next ржП ржжрзЗржЦрж╛рждрзЗ ржкрж╛рж░рж┐:

* ЁЯФ╣ `@Configuration` ржЫрж╛рзЬрж╛ `@Bean` ржжрж┐рж▓рзЗ ржХрзА рж╣рзЯ
* ЁЯФ╣ Bean name ржХрзАржнрж╛ржмрзЗ decide рж╣рзЯ
* ЁЯФ╣ Singleton vs Prototype `@Bean`
* ЁЯФ╣ Real project ржП ржХржЦржи `@Bean` ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗ

ржмрж▓рж▓рзЗржЗ ржПржЧрзЛржмрзЛ ЁЯСН
